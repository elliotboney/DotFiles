#!/usr/bin/env bash

# Minimal bashrc for tool compatibility 
# User primarily uses zsh - this loads just the essentials for tool calls

# Essential helper functions
command_exists() {
    type "$1" &> /dev/null ;
}


decho "\x1b[1;36mProcessing .bashrc\x1b[m"

# Basic shell settings
{{- if eq .chezmoi.os "darwin" }}
export SHELL_PLATFORM='OSX'
{{- else if eq .chezmoi.os "linux" }}
export SHELL_PLATFORM='LINUX'
{{- else }}
export SHELL_PLATFORM='BSD'
{{- end }}

# Load essential paths from your existing setup
# Android Tools
{{- if .development }}
export ANDROID_HOME="${HOME}/Code/Android/sdk"
{{- end }}

# Homebrew paths
if command_exists brew; then
{{- if eq .chezmoi.os "darwin" }}
    PATH="$(brew --prefix coreutils)/bin":$PATH
{{- end }}
fi

{{- if eq .chezmoi.os "darwin" }}
if [ -d "/opt/homebrew/opt/coreutils/libexec/gnubin" ]; then
   PATH="/opt/homebrew/opt/coreutils/libexec/gnubin":$PATH
fi
{{- end }}

# Essential paths array (platform-specific)
{{- if eq .chezmoi.os "darwin" }}
paths=(
    "${HOME}/.bin"
    "/opt/homebrew/bin"
    "/usr/local/bin"
    "/usr/local/sbin"
    "/opt/bin"
    "/opt/sbin"
    "/bin"
    "/sbin" 
    "/usr/bin"
    "/usr/sbin"
    )
{{- else }}
paths=(
    "${HOME}/.bin"
    "/usr/local/bin"
    "/usr/local/sbin"
    "/opt/bin"
    "/opt/sbin"
    "/bin"
    "/sbin" 
    "/usr/bin"
    "/usr/sbin"
    )
{{- end }}

# Add paths that exist
for p in "${paths[@]}"; do
    if [ -e "$p" ] || [ -d "$p" ]; then
        PATH="${PATH}:${p}"
    fi
done

export PATH

# Basic aliases
{{- if eq .chezmoi.os "darwin" }}
alias ls='ls -G'
{{- else }}
alias ls='ls --color=auto'
{{- end }}
alias ll='ls -la'

# Done - minimal but functional for tool calls